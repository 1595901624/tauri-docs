---
import Layout from '../../../layouts/Layout.astro'
import { getCollection } from 'astro:content'
import {
  buildLocalizedStaticPaths,
  transformRelativeLocalizedEntrySlug,
} from '../../../utils'

export async function getStaticPaths() {
  return buildLocalizedStaticPaths()
}

// TODO: Need to still list out if non-english page doesn't exist

const { locale } = Astro.params

const collection = await getCollection('api')
const filteredCollection = collection.filter((entry) =>
  entry.slug.startsWith(locale ?? 'en')
)
---

<Layout title="API">
  <h1>API</h1>
  <ul>
    {
      filteredCollection.map((entry) => (
        <li>
          <a href={transformRelativeLocalizedEntrySlug(entry.slug, 'api')}>
            {entry.slug}
          </a>
        </li>
      ))
    }
  </ul>
</Layout>
